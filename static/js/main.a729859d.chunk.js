(this.webpackJsonpmarikit_holding_test=this.webpackJsonpmarikit_holding_test||[]).push([[0],{20:function(e,a,t){e.exports=t.p+"static/media/spinner.00e1caa6.svg"},21:function(e,a,t){e.exports=t(56)},45:function(e,a,t){},46:function(e,a,t){},47:function(e,a,t){},48:function(e,a,t){},49:function(e,a,t){},50:function(e,a,t){},51:function(e,a,t){},52:function(e,a,t){},53:function(e,a,t){},54:function(e,a,t){},55:function(e,a,t){},56:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(19),s=t.n(r),i=t(5),l=t(4),o=t(7),u=t.n(o);function d(e){return+e.toFixed(2)}var m=t(8),p=t.n(m);function y(e,a,t,n){var c=Object(i.a)(t,3),r=c[0],s=c[1],l=c[2];n||a({type:r});return function(){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.a.awrap(e());case 3:return t=n.sent,a({type:s,payload:t.data}),n.abrupt("return",t.data);case 8:throw n.prev=8,n.t0=n.catch(0),a({type:l,payload:n.t0}),n.t0;case 12:case"end":return n.stop()}}),null,null,[[0,8]])}()}function f(e){return e.toFixed(2).replace(".",",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+String.fromCharCode(160))}var v="PRODUCTS_GET",b="PRODUCTS_GET__SUCCESS",N="PRODUCTS_GET__FAIL",_="CATEGORIES_GET",E="CATEGORIES_GET__SUCCESS",g="CATEGORIES_GET__FAIL",h="EXCHANGE_RATES_GET",k="BASKET_PRODUCT_ADD",O="BASKET_PRODUCT_REMOVE",j="QUANTITY_SET",T=[],C=function(e,a){var t,n,c=a.payload;switch(a.type){case _:return Object(l.a)({},e,{fetched:!1});case E:var r=(n=T=c)&&Object.keys(n).map((function(e){var a=Number(e);return{id:a,name:n[a].G,products:Object.keys(n[a].B).map((function(e){return parseInt(e,10)}))}}));return Object(l.a)({},e,{categories:r,fetched:!0});case g:return Object(l.a)({},e,{fetched:!0});case v:return Object(l.a)({},e,{fetched:!1});case b:var s=(t=T,c.Value.Goods.map((function(e){return{id:e.T,name:t[e.G]?t[e.G].B[e.T].N:"-",categoryId:e.G,currency:e.C,available:e.P,quantity:0}})));return Object(l.a)({},e,{products:s,fetched:!0});case N:return Object(l.a)({},e,{fetched:!0});case h:return Object(l.a)({},e,{exchangeRates:c});case k:var i,o=u()(e.basket),d=o.findIndex((function(e){return e.id===c.id})),m=-1!==d;if(!m&&c.available>0){var p=o.push(c);(i=o[p-1]).quantity=0}return m&&(i=o[d]),i&&i.available>0&&i.quantity<i.available&&(i.quantity+=1),Object(l.a)({},e,{basket:o});case O:var y=c.id,f=u()(e.basket),C=f.findIndex((function(e){return e.id===y}));return f.splice(C,1),Object(l.a)({},e,{basket:f});case j:var x=c,I=x.product,B=x.newQuantity,S=u()(e.basket),R=S.findIndex((function(e){return e.id===I.id})),P=S[R];return B>0&&P.available>0&&B<=P.available&&(P.quantity=B),Object(l.a)({},e,{basket:S})}return e},x=t(9),I=t.n(x),B={getProducts:function(){return I.a.get("".concat("/marikit_holding_test","/data.json"))},getCategories:function(){return I.a.get("".concat("/marikit_holding_test","/names.json"))}},S="USD",R=20,P=80,w=15e3;function U(e,a){var t=a.categories,c=a.products,r=a.exchangeRates;Object(n.useEffect)((function(){y(B.getCategories,e,[_,E,g])}),[e]),Object(n.useEffect)((function(){t.length&&y(B.getProducts,e,[v,b,N])}),[t,e]),Object(n.useEffect)((function(){if(c.length){var a,t,n=(a=R,t=P,Math.floor(Math.random()*(t+1-a)+a)),s=n>r.rates.RUB;e({type:h,payload:{rates:{RUB:n,USD:1},base:S,isIncreased:s}})}}),[c,e]),Object(n.useEffect)((function(){var a=setInterval((function(){y(B.getProducts,e,[v,b,N],!0)}),w);return function(){clearInterval(a)}}),[e])}var G={products:[],categories:[],basket:[],exchangeRates:{rates:{RUB:R,USD:1},base:S,isIncreased:!1},fetched:!1},q=Object(n.createContext)({state:G,dispatch:function(){return{}}});function A(){return Object(n.useContext)(q).dispatch}function D(){var e=A();return function(a){var t=a.id;e({type:O,payload:{id:t}})}}function Q(e){return e(Object(n.useContext)(q).state)}function M(){return Q((function(e){return e.categories}))}function F(){return Q((function(e){return e.exchangeRates}))}function L(){return Q((function(e){return e.basket}))}var J=t(6),K=t(3),V=t(2),W=t.n(V),$=(t(45),function e(a){var t=a.disabled,n=a.isBlock,r=a.type,s=void 0===r?"button":r,i=a.styleType,l=void 0===i?"primary":i,o=a.className,u=a.children,d=Object(K.a)(a,["disabled","isBlock","type","styleType","className","children"]),m=W()(o,e.displayName,Object(J.a)({_disabled:t,_block:n},"_".concat(l),l));return c.a.createElement("button",Object.assign({className:m,disabled:t,type:s},d),c.a.createElement("span",{className:"".concat(e.displayName,"__text")},u))});$.displayName="Button";var H=$,X=(t(46),function e(a){var t=a.className,r=a.title,s=a.children,l=a.isCollapsible,o=a.isCollapsed,u=void 0!==o&&o,d=Object(K.a)(a,["className","title","children","isCollapsible","isCollapsed"]),m=Object(n.useState)(u),p=Object(i.a)(m,2),y=p[0],f=p[1],v=W()(t,e.displayName,{_collapsible:l,_collapsed:y});return c.a.createElement("div",Object.assign({className:v},d),c.a.createElement("div",{className:"".concat(e.displayName,"__title"),onClick:function(){return f(!y)}},r),c.a.createElement("div",{className:"".concat(e.displayName,"__content")},s))});X.displayName="Card";var Y=X,z=(t(47),function e(a){var t=a.className,r=a.value,s=a.min,l=void 0===s?1:s,o=a.max,u=void 0===o?1:o,d=a.onChange,m=a.onBlur,p=Object(K.a)(a,["className","value","min","max","onChange","onBlur"]),y=W()(t,e.displayName),f=Object(n.useState)(r),v=Object(i.a)(f,2),b=v[0],N=v[1];return Object(n.useEffect)((function(){b!==r&&N(r)}),[r]),c.a.createElement("input",Object.assign({type:"number",value:b,min:l,max:u,className:y,onChange:function(e){var a=e.target.value?parseInt(e.target.value,10):"";N(a),a&&a>=l&&a<=u&&d&&d(e)},onBlur:function(e){N(r),m&&m(e)}},p))});z.displayName="InputNumber";var Z=z,ee=t(20),ae=t.n(ee),te=(t(48),function e(a){var t=a.className,n=Object(K.a)(a,["className"]),r=W()(t,e.displayName);return c.a.createElement("div",Object.assign({className:r},n),c.a.createElement("img",{className:"".concat(e.displayName,"__img"),src:ae.a,alt:"spinner"}))});te.displayName="Loader";var ne=te,ce=(t(49),function e(a){var t=a.className,n=a.columns,r=a.dataSource,s=a.emptyText,i=void 0===s?"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445":s,l=a.total,o=Object(K.a)(a,["className","columns","dataSource","emptyText","total"]),u=W()(t,e.displayName);return c.a.createElement("div",{className:u},c.a.createElement("table",Object.assign({className:"".concat(e.displayName,"__table")},o),c.a.createElement("thead",{className:"".concat(e.displayName,"__thead")},c.a.createElement("tr",{className:"".concat(e.displayName,"__tr")},n.map((function(a){return c.a.createElement("th",{key:a.key,className:"".concat(e.displayName,"__th")},a.title)})))),c.a.createElement("tbody",{className:"".concat(e.displayName,"__tbody")},r.length?r.map((function(a){return c.a.createElement("tr",{key:a.key,className:"".concat(e.displayName,"__tr")},n.map((function(t){return c.a.createElement("td",{key:"".concat(t.key,"_").concat(a.key),className:"".concat(e.displayName,"__td")},t&&a[t.key])})))})):null),l&&r.length?c.a.createElement("tfoot",null,c.a.createElement("tr",null,n.map((function(a,t){return c.a.createElement("td",{key:"tfoot_".concat(a.key),className:"".concat(e.displayName,"__td")},n.length-1===t&&l)})))):null),r.length?null:c.a.createElement("div",{className:"".concat(e.displayName,"__table-placeholder")},c.a.createElement("div",{className:"".concat(e.displayName,"__table-empty")},i)))});ce.displayName="Table";var re=ce,se=function e(a){var t=a.exchangeRates,n=a.basketProducts,r=a.categories,s=a.setQuantity,i=a.removeProductToBasket,l=n.map((function(e){var a=e.id,n=e.name,l=e.quantity,o=e.available,u=e.categoryId,m=d(e.currency*t.rates.RUB),p=r.find((function(e){return e.id===u})),y=p?"".concat(p.name,". "):"";return{key:a,name:"".concat(y).concat(n),quantity:c.a.createElement(de,{value:l,min:1,max:o,isIncreased:t.isIncreased,onChange:function(a){return s({product:e,newQuantity:parseInt(a.target.value,10)})},addon:"\u0448\u0442.",warningMessage:l===o?"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043e":""}),price:"".concat(f(m)," / \u0448\u0442."),actions:c.a.createElement(H,{styleType:"danger",onClick:function(){return i({id:a})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")}})),o=n.reduce((function(e,a){return e+d(a.currency*a.quantity*t.rates.RUB)}),0);return c.a.createElement(re,{columns:[{title:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name"},{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:"quantity",key:"quantity"},{title:"\u0426\u0435\u043d\u0430",dataIndex:"price",key:"price"},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f",dataIndex:"actions",key:"actions"}],dataSource:l,className:"".concat(e.displayName,"__table"),emptyText:"\u041d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0435",total:"\u041e\u0431\u0449\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c: ".concat(f(o))})};se.displayName="BasketTable";var ie=se,le=function(e){var a=e.productsList,t=e.exchangeRates,n=e.basketProducts,r=e.category,s=e.addProductToBasket,i=e.removeProductToBasket,l=a.filter((function(e){return r.products.includes(e.id)})).map((function(e){var a=e.id,r=e.currency,l=e.available,o=e.name,u=n.find((function(e){return e.id===a})),m=!!u&&u.quantity>0,p=!!u&&u.quantity===l,y=d(r*t.rates.RUB),v=u?l-u.quantity:l;return{key:a,name:o,available:v,price:f(y),actions:c.a.createElement(c.a.Fragment,null,c.a.createElement(H,{onClick:function(){return s(e)},disabled:p},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),m&&c.a.createElement(H,{styleType:"danger",onClick:function(){return i({id:a})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}}));return c.a.createElement(re,{columns:[{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name"},{title:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e",dataIndex:"available",key:"available"},{title:"\u0426\u0435\u043d\u0430",dataIndex:"price",key:"price"},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f",dataIndex:"actions",key:"actions"}],dataSource:l,emptyText:"\u041d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"})};le.displayName="CategoryTable";var oe=le,ue=(t(50),function e(a){var t=a.className,n=a.addon,r=a.warningMessage,s=a.isIncreased,i=Object(K.a)(a,["className","addon","warningMessage","isIncreased"]),l=W()(t,e.displayName),o=W()("".concat(e.displayName,"__input"),{_increased:s,_decreased:!s});return c.a.createElement("div",{className:l},c.a.createElement("div",{className:"".concat(e.displayName,"__control")},c.a.createElement(Z,Object.assign({className:o},i))," ",n&&c.a.createElement("span",{className:"".concat(e.displayName,"__addon")},n)),r&&c.a.createElement("div",{className:"".concat(e.displayName,"__warning")},r))});ue.displayName="InputNumberQuantity";var de=ue,me=(t(51),function e(){var a=F(),t=L(),n=M(),r=function(){var e=A();return function(a){var t=a.product,n=a.newQuantity;e({type:j,payload:{product:t,newQuantity:n}})}}(),s=D();return c.a.createElement("aside",{className:e.displayName},c.a.createElement("h2",{className:"".concat(e.displayName,"__head")},"\u041a\u043e\u0440\u0437\u0438\u043d\u0430"),c.a.createElement(ie,{exchangeRates:a,basketProducts:t,categories:n,setQuantity:r,removeProductToBasket:s}))});me.displayName="Basket";var pe=me,ye=(t(52),function e(){var a=Q((function(e){return e.fetched})),t=Q((function(e){return e.products})),n=M(),r=F(),s=L(),i=function(){var e=A();return function(a){e({type:k,payload:a})}}(),l=D();return c.a.createElement("main",{className:e.displayName},c.a.createElement("h2",null,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0441 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438"),a?n.map((function(e){return c.a.createElement(Y,{isCollapsible:!0,title:e.name,key:e.id},c.a.createElement(oe,{productsList:t,exchangeRates:r,basketProducts:s,category:e,addProductToBasket:i,removeProductToBasket:l}))})):c.a.createElement(ne,null))});ye.displayName="Categories";var fe=ye,ve=(t(53),function e(){return c.a.createElement("div",{className:e.displayName},c.a.createElement(pe,null),c.a.createElement(fe,null))});ve.displayName="CatalogPage";var be=ve,Ne=(t(54),function e(){var a=Object(n.useReducer)(C,G),t=Object(i.a)(a,2),r=t[0],s=t[1];return U(s,r),c.a.createElement(q.Provider,{value:{state:r,dispatch:s}},c.a.createElement("div",{className:e.displayName},c.a.createElement(be,null)))});Ne.displayName="App";var _e=Ne;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(55);s.a.render(c.a.createElement(_e,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[21,1,2]]]);
//# sourceMappingURL=main.a729859d.chunk.js.map